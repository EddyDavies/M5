{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Incident Tracker",
    "description": "A schema for The University of Manchester incident reporting system",
    "definitions": {
      "external_address" : {
        "type": "object",
          "properties": {
            "address_id": {
              "description": "The address id used to attach off-campus address to people or incidents",
              "type": "string",
              "pattern": "^[e|E][0-9]{8}$"
            },
          "house_number": {
            "description": "The house number",
            "type": "number",
            "pattern": "^[0-9]*$"
          },
          "house_number_suffix": {
            "description": "Any letter that may be found following a house number",
            "type": "string",
            "pattern": "^[A-Za-z]"
          },
          "house_name": {
            "description": "The house name that might be instead of or alongside the number",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
  
          },
          "street_name": {
            "description": "The name of the street such as baker, mill, barton",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
  
          },
          "street_type": {
            "description": "The name of the type of street, such as road, avenue, lane",
            "type": "string"
          },
          "street_direction": {
            "description": "The direction of the street, necessary for some addresses",
            "type": "string",
            "pattern": "^[A-Za-z]{1,2}"
          },
          "address_type": {
            "description": "The type of address such as Building, Office, PO Box, Apartment ",
            "type": "string",
            "default": "House",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "address_type_identifier": {
            "description": "The Building number, PO Box number, Apartment floor etc",
            "type": "string",
            "default": "House",
            "pattern": "^[0-9]*"
          },
          "locality": {
            "description": "The local area of this address, such as village or area of city",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
  
          },
          "city": {
            "description": "The city or town for this address",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "governing_district": {
            "description": "The governing district, such as county, state or province this address is in",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "post_code": {
            "description": "The postcode for this address",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_ ]*$"
          },
          "country": {
            "description": "The country this address is in",
            "type": "string"
          }
        },
        "oneOf": [ {
          "required": [
            "address_id",
            "house_number",
            "street_name",
            "street_type",
            "city",
            "governing_district",
            "post_code",
            "country"
          ]},{
          "required": [
            "address_id",
            "house_name",
            "street_name",
            "street_type",
            "city",
            "governing_district",
            "post_code",
            "country"
          ]}
        ],
        "additionalProperties":false
      },
      "internal_address" : {
        "type": "object",
          "properties": {
            "address_id": {
              "description": "The address id used to attach campus address to people or incidents",
              "type": "string",
              "pattern": "^[i|I][0-9]{8}$"
            },
          "room_code": {
            "description": "The room identifying code following university standardised naming convention",
            "type": "string",
            "pattern": "^[0-9A-Za-z]*$"
          },
          "floor": {
            "description": "The floor number that the room is on",
            "type": "number",
            "pattern": "^[0-9]{1,2}*$"
          },
          "buiding_name": {
            "description": "The building name that room is situated in",
            "type": "string"
          },
          "department": {
            "description": "The department that the room is situated in",
            "type": "string"
          }
        },
          "required": [
          "address_id",
        "room_code",
        "buiding_name"
        ],
        "additionalProperties":false
      },
      "person": {
        "type": "object",
        "properties": {
          "person_id": {
            "description": "The unique identifier for an individual",
            "type": "integer",
            "pattern": "^[0-9]*$"
          },
          "first_name": {
            "description": "The individuals first name with support for international names.",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_]*$"
  
          },
          "middle_names": {
            "description": "Any middle names an individual has with support for international names.",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_ ]*$"
          },
          "last_name": {
            "description": "The individuals last name with support for international names.",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_]*$"
          },
          "address": {
            "description": "The individuals last name",
            "type": "array",
            "items": {
              "$ref": "#/definitions/address"
            },
            "uniqueItems": true
          },
          "phone": {
            "description": "An array of the individual's phone number/s",
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[+]?[0-9- ]*$"
            },
            "uniqueItems": true
          },
          "email": {
            "description": "An array of the individual's email address/es",
            "type": "array",
            "items": {
              "type": "string",
              "format": "email"
            },
            "uniqueItems": true
          }
        },
        "required": [
          "person_id",
          "first_name"
        ],
        "additionalProperties":false
      }
    },
    "type": "object",
    "properties": {
        "root" :{
            "type" : "object",
            "properties": {
                "people" : {
          "type" :"array",
                    "items" : { "$ref": "#/definitions/person"},
                    "minItems" : 1
                },
                "incidents" : {
                    "type" : "array",
                    "items": {"$ref": "#/definitions/incident"},
          "minItems" : 1
                },
                "address" : {
                    "type" : "array",
                    "items": {"$ref": "#/definitions/external_address"}
                },
                "campus_rooms" : {
                    "type" : "array",
                    "items": {"$ref": "#/definitions/internal_address"}
                }
                },
                "required": ["people", "incidents", "address", "campus_rooms"]
          }},
      "required" : ["root"],
      "uniqueItems": true
  
  }
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Incident Tracker",
    "description": "A schema for The University of Manchester incident reporting system",
    "definitions": {
      "address" : {
        "type": "object",
        "properties": {
          "address_id": {
            "description": "The address id used to attach off-campus address to people or incidents",
            "type": "string",
            "pattern": "^[o|O][0-9]{8}$"
          },
          "street_address" : {
            "type": "object",
            "properties": {
              "flat_number": {
                "description": "The flat, office or apartment number",
                "type": "number",
                "pattern": "^[0-9]*$"
              },
          "house_number": {
            "description": "The house number",
            "type": "number",
            "pattern": "^[0-9]*$"
          },
          "house_number_suffix": {
            "description": "Any letter that may be found following a house number",
            "type": "string",
            "pattern": "^[A-Za-z]"
          },
          "house_name": {
            "description": "The house name that might be instead of or alongside the number",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "street_name": {
            "description": "The name of the street such as baker, mill, barton",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "street_type": {
            "description": "The name of the type of street, such as road, avenue, lane",
            "type": "string"
          },
          "street_direction": {
            "description": "The direction of the street, necessary for some addresses",
            "type": "string",
            "pattern": "^[A-Za-z]{1,2}"
          },
          "address_type": {
                "description": "The type of address such as Building, Office, Apartment ",
            "type": "string",
            "default": "House",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
              }
          },
            "oneOf": [ {
              "required": [
                "house_number",
                "street_name",
                "street_type",
                "address_type"
              ]},{
              "required": [
                "house_name",
                "street_name",
                "street_type",
                "address_type"
              ]}
            ],
            "additionalProperties":false
          },
          "locality": {
            "description": "The local area of this address, such as village or area of city",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "city": {
            "description": "The city or town for this address",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "governing_district": {
            "description": "The governing district, such as county, state or province this address is in",
            "type": "string",
            "pattern": "^([A-Z][a-z]*[ ]?)*"
          },
          "post_code": {
            "description": "The postcode for this address",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_ ]*$"
          },
          "country": {
            "description": "The country this address is in",
            "type": "string"
          }
        },
        "required": [
          "address_id",
          "street_address",
          "city",
          "governing_district",
          "post_code",
          "country"
        ],
        "additionalProperties":false
      },
      "campus_rooms" : {
        "type": "object",
          "properties": {
          "address_id": {
            "description": "The address id used to attach campus rooms to people or incidents",
            "type": "string",
            "pattern": "^[c|C][0-9]{8}$"
          },
          "room_code": {
            "description": "The room identifying code following university naming convention",
            "type": "string",
            "pattern": "^[0-9A-Za-z]*$"
          },
          "floor": {
            "description": "The floor number that the room is on",
            "type": "number",
            "pattern": "^[0-9]{1,2}*$"
          },
          "buiding_name": {
            "description": "The building name that room is situated in",
            "type": "string"
          },
          "department": {
            "description": "The department that the room is situated in",
            "type": "string"
          }
        },
        "required": [
          "address_id",
          "room_code",
          "buiding_name"
        ],
        "additionalProperties":false
      },
      "person": {
        "type": "object",
        "properties": {
          "person_id": {
            "description": "The unique identifier for an individual to connect it to the incident objects",
            "type": "string",
            "pattern": "[p|P][0-9]{8}$"
          },
          "first_name": {
            "description": "The individuals first name.",
            "type": "string",
            "pattern": "^[^ ]*$"
          },
          "middle_names": {
            "description": "Any middle names an individual has.",
            "type": "string"
          },
          "last_name": {
            "description": "The individuals last name.",
            "type": "string",
            "pattern": "^[^ ]*$"
          },
          "date_of_birth": {
            "description": "The individuals Date of Birth.",
            "type": "string",
            "pattern": "^([1-9]|0[1-9]|[12][0-9]|3[01])\/([1-9]|0[1-9]|1[012])\/(19|20)?[0-9]{2}$"
          },

          "status": {
            "description": "The individuals status, as staff, student or guest",
            "type": "string",
            "enum": ["Staff", "Student", "Guest"]
          },
          "job_title": {
            "description": "The individuals job title for staff members.",
            "type": "string",
            "pattern": "^[a-zA-Z0-9_]*$"
          },
          "manager": {
            "description": "The person ID for the individuals line manager if they are a staff member.",
            "type": "string",
            "pattern": "[p|P][0-9]{8}$"
          },
          "address": {
            "description": "The ID number for individuals home address.",
            "type": "string",
            "pattern": "[o|O][0-9]{8}$"
          },
          "office": {
            "description": "The ID number for individuals office if they are memeber of staff with one.",
            "type": "string",
            "pattern": "[i|I][0-9]{8}$"
          },
          "phone": {
            "description": "An array of the individual's phone number/s",
            "type": "array",
            "items": {
              "type": "string",
              "pattern": "^[+]?[0-9- ]*$"
            },
            "uniqueItems": true
          },
          "email": {
            "description": "An array of the individual's email address/es",
            "type": "array",
            "items": {
              "type": "string",
              "format": "email"
            },
            "uniqueItems": true
          }
        },
        "required": [
          "person_id",
          "first_name",
          "status"
        ],
        "additionalProperties":false
      },
      "incident": {
        "type": "object",
        "properties": {
          "incident_id": {
            "description": "The unique identifier for the incident",
            "type": "string",
            "pattern": "[i|I][0-9]{8}$"
          }
      }  
      }
    },
    "type": "object",
    "properties": {
        "root" :{
            "type" : "object",
            "properties": {
                "people" : {
                    "type" :"array",
                    "items" : { "$ref": "#/definitions/person"},
                    "minItems" : 1
                },
                "incidents" : {
                    "type" : "array",
                    "items": {"$ref": "#/definitions/incident"},
                    "minItems" : 1
                },
                "address" : {
                    "type" : "array",
                    "items": {"$ref": "#/definitions/address"}
                },
                "campus_rooms" : {
                    "type" : "array",
                    "items": {"$ref": "#/definitions/campus_room"}
                }
                },
                "required": ["people", "incidents", "address", "campus_rooms"]
            }},
      "required" : ["root"],
      "uniqueItems": true
  
  }